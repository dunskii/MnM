# Music 'n Me Backend - Production Environment Variables
# Copy this file to .env.production and fill in actual values
# NEVER commit the .env.production file to version control

# ===================================
# Application Configuration
# ===================================
NODE_ENV=production
PORT=5000
API_PREFIX=/api/v1

# ===================================
# Database Configuration
# ===================================
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public&sslmode=require
DATABASE_URL=postgresql://username:password@host.db.ondigitalocean.com:25060/musicnme?sslmode=require

# ===================================
# Redis Configuration (Bull Queues)
# ===================================
# Format: redis://:PASSWORD@HOST:PORT
REDIS_URL=redis://:password@host.redis.ondigitalocean.com:25061

# ===================================
# Security & Authentication
# ===================================

# JWT Secrets (generate with: openssl rand -base64 64)
# IMPORTANT: Use different secrets for access and refresh tokens
JWT_SECRET=your-jwt-secret-key-minimum-256-bits-base64-encoded
JWT_REFRESH_SECRET=your-jwt-refresh-secret-key-minimum-256-bits-base64-encoded

# JWT Token Expiration
JWT_EXPIRES_IN=15m        # Access token: 15 minutes
JWT_REFRESH_EXPIRES_IN=7d # Refresh token: 7 days

# Encryption Key for sensitive data (generate with: openssl rand -base64 32)
ENCRYPTION_KEY=your-encryption-key-256-bits-base64-encoded

# ===================================
# Stripe Payment Integration
# ===================================
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_live_your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_signing_secret_here

# Stripe API Version
STRIPE_API_VERSION=2023-10-16

# ===================================
# SendGrid Email Service
# ===================================
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here
SENDGRID_FROM_EMAIL=noreply@musicnme.com.au
SENDGRID_FROM_NAME=Music 'n Me

# SendGrid Template IDs (create in SendGrid dashboard)
SENDGRID_TEMPLATE_WELCOME=d-xxxxxxxxxxxxx
SENDGRID_TEMPLATE_INVOICE=d-xxxxxxxxxxxxx
SENDGRID_TEMPLATE_PAYMENT_CONFIRMATION=d-xxxxxxxxxxxxx
SENDGRID_TEMPLATE_LESSON_REMINDER=d-xxxxxxxxxxxxx
SENDGRID_TEMPLATE_PASSWORD_RESET=d-xxxxxxxxxxxxx

# ===================================
# Google OAuth & Drive API
# ===================================
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret-here
GOOGLE_REDIRECT_URI=https://musicnme.com.au/api/v1/auth/google/callback

# Google Service Account (for Drive sync)
# Store JSON credentials as escaped string or use file path
GOOGLE_SERVICE_ACCOUNT_EMAIL=service-account@project-id.iam.gserviceaccount.com
GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----\n"

# Google Drive Sync Configuration
DRIVE_SYNC_INTERVAL=15  # Minutes between sync jobs
DRIVE_SYNC_ENABLED=true

# ===================================
# Application URLs
# ===================================
FRONTEND_URL=https://musicnme.com.au
BACKEND_URL=https://musicnme.com.au/api/v1

# ===================================
# File Upload Configuration
# ===================================
MAX_FILE_SIZE=10485760  # 10MB in bytes
UPLOAD_PATH=/app/uploads
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,audio/mpeg,audio/wav

# ===================================
# Rate Limiting
# ===================================
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100   # 100 requests per window

# Login rate limiting (stricter)
LOGIN_RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
LOGIN_RATE_LIMIT_MAX_ATTEMPTS=5    # 5 attempts per window

# ===================================
# CORS Configuration
# ===================================
CORS_ORIGIN=https://musicnme.com.au
CORS_CREDENTIALS=true

# ===================================
# Logging & Monitoring
# ===================================
LOG_LEVEL=info  # error, warn, info, debug
LOG_FORMAT=json # json or simple

# Sentry Error Tracking (optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ===================================
# Background Jobs Configuration
# ===================================

# Email Queue Settings
EMAIL_QUEUE_CONCURRENCY=5
EMAIL_QUEUE_RETRY_ATTEMPTS=3
EMAIL_QUEUE_RETRY_DELAY=60000  # 1 minute

# Drive Sync Queue Settings
DRIVE_SYNC_QUEUE_CONCURRENCY=2
DRIVE_SYNC_QUEUE_RETRY_ATTEMPTS=3
DRIVE_SYNC_QUEUE_RETRY_DELAY=300000  # 5 minutes

# ===================================
# Database Optimization
# ===================================
DATABASE_POOL_SIZE=10
DATABASE_CONNECTION_TIMEOUT=10000  # 10 seconds

# ===================================
# Security Headers
# ===================================
HELMET_CSP_ENABLED=true
HELMET_HSTS_MAX_AGE=31536000  # 1 year

# ===================================
# Feature Flags
# ===================================
FEATURE_MEET_AND_GREET=true
FEATURE_HYBRID_LESSONS=true
FEATURE_GOOGLE_DRIVE_SYNC=true
FEATURE_STRIPE_PAYMENTS=true
FEATURE_EMAIL_NOTIFICATIONS=true

# ===================================
# Data Retention & Privacy
# ===================================
DATA_RETENTION_DAYS=2555  # 7 years (Australian requirement)
ACCOUNT_DELETION_GRACE_PERIOD_DAYS=30
ENABLE_GDPR_FEATURES=true

# ===================================
# Session Configuration
# ===================================
SESSION_SECRET=your-session-secret-key-minimum-256-bits
COOKIE_SECURE=true
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=strict
